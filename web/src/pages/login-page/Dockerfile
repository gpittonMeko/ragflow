FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY oauth_backend.py .

ENV PYTHONUNBUFFERED=1

ARG STRIPE_SECRET_KEY
ARG STRIPE_PRICE_PREMIUM
ARG STRIPE_WEBHOOK_SECRET
ARG APP_URL

ENV STRIPE_SECRET_KEY=$STRIPE_SECRET_KEY \
    STRIPE_PRICE_PREMIUM=$STRIPE_PRICE_PREMIUM \
    STRIPE_WEBHOOK_SECRET=$STRIPE_WEBHOOK_SECRET \
    APP_URL=$APP_URL

CMD ["python", "oauth_backend.py"]